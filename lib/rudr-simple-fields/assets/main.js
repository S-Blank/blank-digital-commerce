(()=>{"use strict";jQuery((function(e){e.fn.refreshRepeaterIndexes=function(){var t=this.children(),a=this.data("name");e(t).each((function(t){e(this).find(".smb-repeater-item__field").each((function(i){var n=e(this).data("type"),s=e(this).data("name"),l="textarea"===n?"textarea":"input";e(this).find(l).attr("name",a+"["+t+"]["+s+"]")})),e(this).find(".smb-index").text(t)}))},e("body").on("click",".simple-upload-img-button",(function(t){t.preventDefault();var a=e(this),i=a.next().next().val(),n=wp.media({title:simpleObject.insertImage,library:{type:"image"},button:{text:simpleObject.useThisImage},multiple:!1}).on("select",(function(){var e=n.state().get("selection").first().toJSON();a.removeClass("button").html('<img class="simple-pre-img" src="'+e.url+'" style="max-width:300px;display:block;" />').next().next().val(e.id).next().show()})).on("close",(function(){}));n.on("open",(function(){if(i){var e=n.state().get("selection");attachment=wp.media.attachment(i),attachment.fetch(),e.add(attachment?[attachment]:[])}})),n.open()})),e("body").on("click",".simple-remove-img-button",(function(){return e(this).hide().prev().val("").prev().prev().addClass("button").html(simpleObject.uploadImage),!1})),e("body").on("click",".simple-upload-file-button",(function(t){t.preventDefault();var a=e(this),i=a.next().val(),n=wp.media({title:simpleObject.insertImage,button:{text:simpleObject.useThisImage},multiple:!1}).on("select",(function(){var t=n.state().get("selection").first().toJSON();console.log(t),e(a).removeClass("button").html('<a class="simple-pre-file" href="'+t.url+'">your file</a>').next().next().val(t.id).next().show()})).on("close",(function(){}));n.on("open",(function(){if(i){var e=n.state().get("selection"),t=i;attachment=wp.media.attachment(t),attachment.fetch(),e.add(attachment?[attachment]:[])}})),n.open()})),e(".simple-gallery-field").sortable({items:"li",cursor:"-webkit-grabbing",scrollSensitivity:40}),e(".simple-upload-images-button").click((function(t){t.preventDefault();var a=e(this),i=a.parent().find(".simple-gallery-field"),n=a.data("name"),s=[];i.find("li").each((function(t){s.push(e(this).data("id"))}));var l=wp.media({title:simpleObject.insertImages,library:{type:"image"},button:{text:simpleObject.useThisImages},multiple:!0}).on("select",(function(){var t=l.state().get("selection").map((function(e){return e.toJSON(),e}));i.empty(),t.map((function(e){i.append('<li data-id="'+e.id+'"><span style="background-image:url('+e.attributes.url+')"></span><a href="#" class="simple-gallery-remove">&times;</a><input type="hidden" name="'+n+'[]" value="'+e.id+'" /></li>')})),e(".simple-gallery-field").sortable("refresh")}));l.on("open",(function(){if(s){var e=l.state().get("selection"),t=s.map((function(e){var t=wp.media.attachment(e);return t.fetch(),t}));e.add(t||[])}})),l.open()})),e("body").on("click",".simple-gallery-remove",(function(t){t.preventDefault(),e(this).parent().attr("data-id");var a=e(this).parent().parent();e(this).parent().remove(),a.sortable("refresh")})),e("body").on("mousedown",".simple-gallery-field li",(function(){var t=e(this);t.parent().find("li").removeClass("simple-gallery-active"),t.addClass("simple-gallery-active")})),e(".simple-datepicker").each((function(){var t=e(this);t.datepicker({showAnim:!1,dateFormat:t.data("dateformat"),minDate:t.data("mindate"),maxDate:t.data("maxdate")})})),e(".smf-show-if").each((function(t){var a=e(this).attr("class").split(" "),i="",n="",s=e(this);a.forEach((function(e){e.startsWith("show-if--")&&(e=e.split("--"),i=e[1],n=e[2])}));var l=e('[name="'+i+'"]'),r=l.val();"checkbox"==l.attr("type")&&(r=l.is(":checked")?"yes":"no"),r!=n&&s.hide(),e('[name="'+i+'"]').change((function(){var t=e(this).val();"checkbox"==e(this).attr("type")&&(t=e(this).is(":checked")?"yes":"no"),t!=n?s.hide():s.show()}))})),e("body").on("click",".smb-repeater-add",(function(t){t.preventDefault();var a=e(this).parent().prev();a.children().first().clone().show().appendTo(a),a.refreshRepeaterIndexes()})),e("body").on("click",".smb-repeater-remove",(function(t){t.preventDefault();var a=e(this).closest(".smb-repeater-item"),i=a.parent();a.remove(),i.refreshRepeaterIndexes()}))}))})();